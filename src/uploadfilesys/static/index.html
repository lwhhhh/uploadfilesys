<!DOCTYPE html>
<head>
    <title>
    </title>
    <!--<link href="http://fonts.googleapis.com/css?family=Lato:100,300,400,700" media="all" rel="stylesheet" type="text/css" />-->
    <link href="/static/stylesheets/bootstrap.min.css" media="all" rel="stylesheet" type="text/css"/>
    <link href="/static/stylesheets/font-awesome.css" media="all" rel="stylesheet" type="text/css"/>
    <link href="/static/stylesheets/se7en-font.css" media="all" rel="stylesheet" type="text/css"/>
    <link href="/static/stylesheets/style.css" media="all" rel="stylesheet" type="text/css"/>
    <script src="/static/javascripts/jquery.min.js" type="text/javascript"></script>
    <script src="/static/javascripts/jquery-ui.js" type="text/javascript"></script>
    <script src="/static/javascripts/bootstrap.min.js" type="text/javascript"></script>
    <script src="/static/javascripts/modernizr.custom.js" type="text/javascript"></script>
    <script src="/static/javascripts/main.js" type="text/javascript"></script>
    <script src="http://static.runoob.com/assets/jquery-validation-1.14.0/lib/jquery.js"></script>
    <script src="http://static.runoob.com/assets/jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport">
</head>
<body class="login2">
<!-- Login Screen -->
<div class="login-wrapper">
    <a href="index.html"><img width="100" height="100" src="images/logo_beego.png"/></a>
    <h3>软件2班作业提交 beta v0.1</h3>
    <form method="post" enctype="multipart/form-data" id="form" name="form">
        <div class="form-group">
            <select class="form-control" name="title" id="title">
                <option value="Java第三次实验">Java第三次实验(截止到11月2号)</option>
                <option value="Java第四次实验">Java第四次实验</option>
                <option value="Java第五次实验">Java第五次实验</option>
                <option value="Java第六次实验">Java第六次实验</option>
                <option value="数据库实验">数据库实验(截止到15周)</option>
            </select>
        </div>
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon">*</span>
                <input class="form-control" placeholder="完整学号:" type="text" name="id" id="id" required>
            </div>
        </div>
        <div class="form-group">
            <div class="input-group">
                <span class="input-group-addon">*</span>
                <input class="form-control" placeholder="姓名:" type="text" name="name" id="name" required>
            </div>
        </div>
        <div class="col-md-15">
            <div class="form-group">
                <div class="input-group">
                    <input type="file" name="file">
                </div>
            </div>
        </div>
        <input class="btn btn-lg btn-primary btn-block" type="submit" value="上传">

    </form>
    <p><a href="https://github.com/lwhhhh/uploadfilesys">Follow Github</a></p>
</div>
<!-- End Login Screen -->
</body>
<script>
    $("form#form").submit(function () {
        var formData = new FormData($(this)[0]);
        var filepath = $("input[name='file']").val();
        var extStart = filepath.lastIndexOf(".");
        var ext = filepath.substring(extStart, filepath.length).toUpperCase();
        if (ext == ".RAR" || ext == ".ZIP") {
            if (confirm("上传文件后无法撤销,是否确认信息填写无误?")) {
                $.ajax({
                    url: "/file",
                    type: "POST",
                    data: formData,
                    async: true,
                    success: function (resp) {
                        alert(resp)
                    },
                    error: function (resp) {
                        alert(resp)
                    },
                    cache: false,
                    contentType: false,
                    processData: false
                });
                return false;   // 不加这句表单post后会跳转到index.html, why ?
            }
        } else {
            alert("只允许上传zip或rar文件");
            return false;   // why ?
        }

    });
</script>
</html>